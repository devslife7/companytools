generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model Cocktail {
  id           Int            @id @default(autoincrement())
  name         String         @unique @db.VarChar(255)
  method       CocktailMethod @default(Build)
  createdAt    DateTime       @default(now()) @map("created_at")
  updatedAt    DateTime       @updatedAt @map("updated_at")
  createdBy    String?        @map("created_by") @db.VarChar(255)
  isActive     Boolean        @default(true) @map("is_active")
  tags         String[]       @default([])
  category     String?        @db.VarChar(100)
  featured     Boolean        @default(false)
  image        String?        @db.VarChar(255)
  abv          Float?         // Alcohol by Volume percentage (e.g. 15.5)
  menuPrice    Decimal?       @map("menu_price") @db.Decimal(10, 2)
  instructions String?
  glass        String?        @db.VarChar(100)
  season       String?        @db.VarChar(50)
  ingredients  Ingredient[]

  @@index([name])
  @@index([isActive])
  @@index([category])
  @@index([featured])
  @@index([season])
  @@map("cocktails")
}

model Ingredient {
  id            Int      @id @default(autoincrement())
  cocktailId    Int      @map("cocktail_id")
  name          String   @db.VarChar(255)
  amount        Decimal  @db.Decimal(10, 3)
  orderIndex    Int      @map("order_index")
  unit          String?  @map("unit") @db.VarChar(50)
  orderUnit     String?  @map("order_unit") @db.VarChar(50)
  cocktail      Cocktail @relation(fields: [cocktailId], references: [id], onDelete: Cascade)

  @@index([cocktailId])
  @@index([name])
  @@map("ingredients")
}

model LiquorPrice {
  id           Int      @id @default(autoincrement())
  name         String   @unique @db.VarChar(255)
  bottlePrice  Decimal  @map("bottle_price") @db.Decimal(10, 2)
  bottleSizeMl Int      @default(750) @map("bottle_size_ml")
  createdAt    DateTime @default(now()) @map("created_at")
  updatedAt    DateTime @updatedAt @map("updated_at")

  @@map("liquor_prices")
}

model SavedEvent {
  id        Int      @id @default(autoincrement())
  name      String   @db.VarChar(255)
  eventDate DateTime @map("event_date")
  recipes   Json
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")

  @@map("saved_events")
}

model Feedback {
  id        Int      @id @default(autoincrement())
  type      String   @db.VarChar(20)
  page      String   @db.VarChar(100)
  message   String
  createdAt DateTime @default(now()) @map("created_at")

  @@index([type])
  @@map("feedback")
}

enum CocktailMethod {
  Shake
  Build
}
